---
title: 模拟面试
date: 2021-04-11 22:30:58
tags: interview
---
### 模拟面试



#### HashMap

- resize（） tanster（） 数组+链表/红黑树 并发使用CurrentHashMap 分段锁 HashTable整锁
- 为什么是2倍？ 方便位运算 rehash

#### CurrentHashMap

- 结构与HashMap基本一致，Node包括 key value next 指向下一Node
- 负载因子不可修改
- Node.hash字段一般>=0  :
- 线程安全 sychronized 锁通的头节点  若为空则CAS
- 寻址算法：key的hashcode 扰动运算  高16低16

#### Spring

-  事务隔离级别、传播特性

-  AOP 动态代理是Spring实现AOP的默认方式，分为两种：**JDK动态代理**和**CGLIB动态代理**。JDK动态代理面向接口，通过反射生成目标代理接口的匿名实现类；CGLIB动态代理则通过继承，使用字节码增强技术（或者`objenesis`类库）为目标代理类生成代理子类。Spring默认对接口实现使用JDK动态代理，对具体类使用CGLIB，同时也支持配置全局使用CGLIB来生成代理对象。



#### 设计模式

- 观察者模式：一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态变化时，会通知所有的观察者对象；rabbitmq中的fanout模式
- 代理模式：给一个对象提供一个对象，通过代理对象控制源对象的引用。生活中例子 中介；



#### 索引

- 主键、唯一、联合、全文、普通，聚簇索引 叶子节点 行数据  回表查询



#### 微服务

- Ribbon是客户端负载均衡，从注册中心读取目标服务器信息，然后客户端采用轮询策略对服务直接访问，全程在客户端操作。注解为**@LoadBalanced**  与Nginx区别：Nginx服务端，Ribbon客户端

- Hystrix预防雪崩：友好提示，

    - 服务降级：接口调用失败就调用本地的方法返回一个空

    - 服务熔断：接口调用失败就会进入调用接口提前定义好的一个熔断的方法，返回错误信息

    - 服务隔离：隔离服务之间相互影响

    - 服务监控：在服务发生调用时,会将每秒请求数、成功请求数等运行指标记录下来。

- 服务降级：当客户端请求服务器端的时候，防止客户端一直等待，不会处理业务逻辑代码，直接返回一个友好的提示给客户端。

- 服务熔断是在服务降级的基础上更直接的一种保护方式，当在一个统计时间范围内的请求失败数量达到设定值（requestVolumeThreshold）或当前的请求错误率达到设定的错误率阈值（errorThresholdPercentage）时开启断路，之后的请求直接走fallback方法，在设定时间（sleepWindowInMilliseconds）后尝试恢复。

- 服务隔离就是Hystrix为隔离的服务开启一个独立的线程池，这样在高并发的情况下不会影响其他服务。服务隔离有线程池和信号量两种实现方式，一般使用线程池方式。

- Feign 是一个声明web服务客户端，这使得编写web服务客户端更容易 **调用方法要和本地抽象方法的签名完全一致**
